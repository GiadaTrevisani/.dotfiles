layout_anaconda() {
  source $HOME/.shellconfig/env
  condanew() {
    if [ -n "$1" ]; then
      conda create -n $(basename "$PWD") python=$1 --no-default-packages -y
    else
      conda create -n $(basename "$PWD") python --no-default-packages -y
    fi;

    source activate $(basename "$PWD")
  }

  if [ -n "$1" ]; then
    source activate $(basename "$PWD") || condanew $1
  else
    source activate $(basename "$PWD") || condanew
  fi;
}

layout_anacondaenv() {
  source $HOME/.shellconfig/env
  if [ -n "$1" ]; then
    # Explicit environment name from layout command.
    local env_name="$1"
    source activate ${env_name}
  elif (grep -q name: environment.yml); then
    # Detect environment name from `environment.yml` file in `.envrc` directory
    source activate `grep name: environment.yml | sed -e 's/name: //' | cut -d "'" -f 2 | cut -d '"' -f 2`
  else
    (>&2 echo No environment specified);
    exit 1;
  fi;
}